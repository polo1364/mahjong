# 台灣16張麻將遊戲 - 優化版

## 🎮 遊戲特色

本遊戲完整實作台灣16張麻將規則（明星3缺1玩法），提供單機練習與娛樂體驗。遊戲支援完整的碰牌、槓牌功能，並實作正確的花牌處理機制。玩家可以選擇啟用或關閉金牌系統，金牌會以金色漸層顯示並有發光動畫效果。AI對手會根據向聽數和風險評估智能出牌，提供具有挑戰性的遊戲體驗。

### ✨ 完整功能

遊戲實作完整台灣16張麻將規則，支援明星3缺1玩法。玩家可以進行碰牌和槓牌操作，增加遊戲策略性。金牌系統可選擇啟用或關閉，啟用時金牌會以金色顯示並有發光提示。AI對手使用智能演算法，會根據向聽數和風險評估選擇最佳出牌策略。計分系統完整支援自摸、門清自摸、對對胡、七對子、混一色、清一色等台數計算。花牌處理完全符合正規麻將規則，摸到花牌會自動從王牌補牌。

### 🌸 花牌規則（完整實作）

**發牌時的花牌處理**
發牌完成後，系統會自動檢查每位玩家的手牌。若手牌中有花牌，會將花牌移至花牌區，並從王牌尾端補牌。若補到的牌仍是花牌，會繼續補牌直到補到非花牌為止。這個過程會在遊戲開始前自動完成，確保每位玩家手牌中沒有花牌。

**遊戲中摸到花牌**
在遊戲進行中，當玩家從牌山摸牌時若摸到花牌，該花牌會自動移至花牌區，並從王牌尾端補一張牌。若補到的牌仍是花牌，會繼續從王牌補牌，直到補到非花牌為止。這個過程是自動進行的，玩家無需手動操作。

**槓牌後的補牌**
當玩家進行槓牌後，會從王牌尾端補一張牌。若補到花牌，該花牌會移至花牌區，並繼續從王牌補牌，直到補到非花牌為止。這符合正規麻將規則中「槓上開花」的機制。

**王牌機制**
遊戲保留14張牌作為王牌（死牌），用於花牌和槓牌的補牌。補牌時優先從王牌尾端抽取。若王牌用完，則從一般牌山補牌。這確保遊戲流程的完整性和公平性。

**花牌計台**
每朵花牌在胡牌時計算1台。花牌包含春夏秋冬（H1-H4）和梅蘭竹菊（H5-H8）共8張。花牌越多，胡牌時的台數越高，獲得的分數也越多。

### 🎨 視覺優化

遊戲採用深藍色漸層背景，營造專業麻將桌氛圍。牌面設計精美，使用白色漸層底色，金牌則有金色漸層與脈動發光動畫效果。所有元素都加入陰影與立體感，提升視覺質感。牌面懸停時會上浮並產生脈動動畫，增加互動趣味性。按鈕使用漸層、陰影和懸停效果，提供良好的視覺回饋。遊戲介面加入emoji圖示，增加視覺趣味性和易讀性。

### 📱 響應式設計

遊戲完美適配手機與電腦螢幕，針對480px、768px等不同斷點進行優化。觸控設計友好，移除點擊高亮效果，避免誤觸干擾。採用自適應佈局，手牌、按鈕等元素會根據螢幕大小自動調整尺寸和間距。在小螢幕上會自動縮小字體和牌面尺寸，確保所有內容都能完整顯示。遊戲禁止用戶縮放，避免誤觸導致頁面縮放影響遊戲體驗。

### 🎯 遊戲機制

當玩家可以進行胡牌、碰牌或槓牌時，系統會彈出反應選擇面板，讓玩家選擇要執行的動作。戰況記錄會即時顯示遊戲進程，包含摸牌、出牌、碰牌、槓牌、胡牌等所有動作。當牌山枯竭時會自動流局並開始下一局。若有玩家破產（分數歸零或負數），遊戲會結束。勝負後會自動開始下一局，保持遊戲的連續性。

## 🎲 遊戲規則

### 基本規則

每位玩家持有16張牌（包含摸牌後的狀態）。莊家固定為東家（玩家本人）。底分為50，每台100分。每位玩家起始分數為100,000分。遊戲使用標準台灣麻將牌，包含萬、筒、條各36張，風牌16張，箭牌12張，花牌8張，共144張牌。

### 胡牌型態

**一般型胡牌**
需要5組面子加1對將。面子可以是順子（三張連續的同花色序數牌）或刻子（三張相同的牌）。將牌是一對相同的牌。例如：123萬、456筒、789條、東東東、南南南、中中（將）。

**七對子**
需要8對對子，共16張牌。每對都是兩張相同的牌，且8對都不相同。例如：11萬、22萬、33筒、44筒、55條、66條、東東、中中。七對子胡牌計4台。

### 台數計算

遊戲實作完整的台數計算系統。自摸加1台，門清自摸（沒有碰或槓）加3台。對對胡（全部都是刻子）加2台，七對子加4台。混一色（只有一種序數牌加字牌）加3台，清一色（只有一種序數牌）加5台。每朵花牌加1台。若啟用金牌，每張金牌加1台，胡在金牌上額外加3台。

### 花牌規則

花牌包含春夏秋冬梅蘭竹菊共8張。摸到花牌會自動從王牌補牌，補到花牌會繼續補牌。槓牌後也從王牌補牌。每朵花牌在胡牌時計1台。花牌不計入手牌張數，單獨顯示在花牌區。

## 🚀 使用方式

### 開啟遊戲

直接用瀏覽器開啟 `index.html` 即可開始遊戲。也可以使用本地伺服器：執行 `python3 -m http.server 8080` 後，在瀏覽器開啟 `http://localhost:8080`。遊戲會自動開始第一局，無需額外設定。

### 操作說明

**摸牌**：輪到你時，點擊「摸牌」按鈕從牌山摸一張牌。摸到花牌會自動補牌。

**出牌**：點擊手牌中要打出的牌。出牌後會檢查其他玩家是否可以胡、碰、槓。

**胡牌**：摸到可以胡的牌時，「胡牌」按鈕會啟用，點擊即可胡牌。若其他玩家出牌你可以胡，會彈出選擇面板。

**碰牌**：其他玩家出牌時，若你手上有兩張相同的牌，會彈出「碰」按鈕。點擊後會將三張牌組成一組碰，並輪到你出牌。

**槓牌**：其他玩家出牌時，若你手上有三張相同的牌，會彈出「槓」按鈕。點擊後會將四張牌組成一組槓，並從王牌補一張牌。

**過**：當可以進行碰或槓時，若不想執行，可以點擊「過」按鈕放棄。

**開新局**：點擊右上角「開始新局」可以重新開始遊戲，所有玩家分數會重置。

### 金牌設定

遊戲開始前可勾選或取消「啟用金牌」選項。金牌啟用時，每局會隨機選擇3張牌作為金牌，顯示在玩家資訊下方。金牌會以金色顯示並有發光動畫效果，讓玩家容易辨識。持有金牌可以增加台數，胡在金牌上會有額外加台。

## 💻 技術特點

### 純前端實作

遊戲使用單一HTML檔案，包含CSS和JavaScript，無需後端伺服器即可運行。遊戲可以完全離線遊玩，不需要網路連線。沒有外部依賴，開箱即用，下載後直接開啟即可。

### 程式架構

**牌型系統**：完整定義萬、筒、條、風、箭、花牌等所有牌型，使用物件導向設計。

**胡牌判定**：實作完整的胡牌判定演算法，支援一般型（5面子1對將）和七對子兩種胡牌型態。演算法使用遞迴方式拆解面子，確保判定的正確性。

**AI系統**：AI使用向聽數計算來評估手牌距離胡牌的距離，並根據風險評估選擇最佳出牌。向聽數越小代表越接近胡牌，AI會優先打出不影響向聽數的牌。

**狀態管理**：使用集中式遊戲狀態管理，所有遊戲資料都儲存在全域狀態物件中，方便管理和除錯。

**事件驅動**：遊戲基於回合制的事件驅動架構，每個動作都會觸發相應的事件處理函數，確保遊戲流程的正確性。

### 響應式CSS

使用Flexbox佈局實現靈活的版面配置。透過Media Queries適配不同螢幕尺寸，包含手機、平板、電腦等裝置。加入CSS動畫與過渡效果，提升使用者體驗。使用漸層與陰影創造視覺深度，讓介面更有質感。

## 📊 優化項目

相較於原版，本優化版進行了以下改進：

**功能完善**：新增完整的碰牌與槓牌功能，包含反應選擇面板。完善花牌規則，實作正確的補牌機制（從王牌補牌）。優化AI出牌邏輯，使用向聽數計算提升AI智能度。

**視覺提升**：優化手機與電腦的響應式設計，完美適配各種螢幕。提升視覺美觀度，加入漸層、陰影、動畫效果。改善牌面設計與互動效果，懸停時有上浮和脈動動畫。加入emoji圖示增加趣味性和易讀性。

**體驗改善**：完善遊戲流程與提示，即時顯示戰況記錄。優化戰況記錄顯示，加入時間戳記和捲軸。改善按鈕與控制項設計，提供更好的視覺回饋。

## 🎯 適用場景

本遊戲適合用於單機麻將練習，讓玩家熟悉台灣16張麻將的規則和玩法。也適合學習台灣16張麻將規則的初學者，透過實際遊玩理解規則。可作為休閒娛樂使用，隨時隨地享受麻將樂趣。支援手機與電腦，無論在何處都能遊玩。

## 📝 注意事項

AI會自動進行碰牌和槓牌的判斷，並有一定機率選擇執行或放棄。遊戲會自動處理花牌補牌，玩家無需手動操作。當有玩家破產（分數歸零或負數）時，遊戲會結束，需要重新開局。建議使用現代瀏覽器（Chrome、Firefox、Safari、Edge）以獲得最佳體驗。遊戲狀態不會儲存，重新整理頁面會重新開始。

---

**享受遊戲！** 🀄🎉

